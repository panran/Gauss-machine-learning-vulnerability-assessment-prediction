import  re
import xlrd
import  xlwt
import time
vulu=[]
mess=[]
mm=[]
data=xlrd.open_workbook('../data/NVD漏洞信息描述.xls')
sheet=data.sheet_by_index(0)
n_row=sheet.nrows
print("数据条数：",n_row)
#数据条数

for i in  range(n_row):
    v=sheet.row(i)[0].value
    m=re.findall(r'\b\w\S*?\.c\b',sheet.row(i)[1].value)
    vulu.append(v)
    mess.append(m)
for k in mess:
    if len(k)!=0:
        mm.append(k)

print("length",mess.__len__())
#for n in mess:
#   print(len(n),n.__len__(),n)
file = xlwt.Workbook()
sheet1 = file.add_sheet(u'sheet1', cell_overwrite_ok=True)
#sheet1.write(0, 0, "漏洞源文件位置")

for n in range(mm.__len__()):
    for l in range(mm[n].__len__()):
        sheet1.write(n,l,mm[n][l])
        #将发现过漏洞的文件信息存入excel表格
        #每行可以有多条数据
filename='漏洞文件位置信息'+time.strftime('%Y-%m-%d',time.localtime(time.time()))+'.xls'
file.save("../data/"+filename)
#保存文件
print(time.strftime('%Y-%m-%d',time.localtime(time.time())))